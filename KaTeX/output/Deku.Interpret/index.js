// Generated by purs version 0.15.9
import * as $foreign from "./foreign.js";
import * as Bolson_Control from "../Bolson.Control/index.js";
import * as Bolson_Core from "../Bolson.Core/index.js";
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Control_Monad_Free from "../Control.Monad.Free/index.js";
import * as Control_Monad_ST_Internal from "../Control.Monad.ST.Internal/index.js";
import * as Control_Plus from "../Control.Plus/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Monoid from "../Data.Monoid/index.js";
import * as Data_Newtype from "../Data.Newtype/index.js";
import * as Data_Semigroup from "../Data.Semigroup/index.js";
import * as Data_Semiring from "../Data.Semiring/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_String_Utils from "../Data.String.Utils/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Effect from "../Effect/index.js";
import * as FRP_Event from "../FRP.Event/index.js";
import * as Random_LCG from "../Random.LCG/index.js";
import * as Safe_Coerce from "../Safe.Coerce/index.js";
import * as Test_QuickCheck_Arbitrary from "../Test.QuickCheck.Arbitrary/index.js";
import * as Test_QuickCheck_Gen from "../Test.QuickCheck.Gen/index.js";
var map = /* #__PURE__ */ Data_Functor.map(FRP_Event.functorEvent);
var map1 = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorFn);
var map2 = /* #__PURE__ */ Data_Functor.map(Effect.functorEffect);
var $$void = /* #__PURE__ */ Data_Functor["void"](Control_Monad_ST_Internal.functorST);
var append = /* #__PURE__ */ Data_Semigroup.append(Data_Semigroup.semigroupArray);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var arbitrary = /* #__PURE__ */ Test_QuickCheck_Arbitrary.arbitrary(Test_QuickCheck_Arbitrary.arbInt);
var add = /* #__PURE__ */ Data_Semiring.add(Data_Semiring.semiringInt);
var pure = /* #__PURE__ */ Control_Applicative.pure(Control_Monad_ST_Internal.applicativeST);
var pure1 = /* #__PURE__ */ Control_Applicative.pure(Effect.applicativeEffect);
var mempty = /* #__PURE__ */ Data_Monoid.mempty(/* #__PURE__ */ Data_Monoid.monoidFn(/* #__PURE__ */ Control_Monad_ST_Internal.monoidST(Data_Monoid.monoidUnit)));
var empty = /* #__PURE__ */ Control_Plus.empty(FRP_Event.plusEvent);
var coerce = /* #__PURE__ */ Safe_Coerce.coerce();
var unwrap = /* #__PURE__ */ Data_Newtype.unwrap();
var eq = /* #__PURE__ */ Data_Eq.eq(Bolson_Core.eqScope);
var join = /* #__PURE__ */ Control_Bind.join(Control_Monad_Free.freeBind);
var pure2 = /* #__PURE__ */ Control_Applicative.pure(FRP_Event.applicativeEvent);
var MakeElement = /* #__PURE__ */ (function () {
    function MakeElement(value0) {
        this.value0 = value0;
    };
    MakeElement.create = function (value0) {
        return new MakeElement(value0);
    };
    return MakeElement;
})();
var MakeText = /* #__PURE__ */ (function () {
    function MakeText(value0) {
        this.value0 = value0;
    };
    MakeText.create = function (value0) {
        return new MakeText(value0);
    };
    return MakeText;
})();
var MakeOpenDynBeacon = /* #__PURE__ */ (function () {
    function MakeOpenDynBeacon(value0) {
        this.value0 = value0;
    };
    MakeOpenDynBeacon.create = function (value0) {
        return new MakeOpenDynBeacon(value0);
    };
    return MakeOpenDynBeacon;
})();
var MakeCloseDynBeacon = /* #__PURE__ */ (function () {
    function MakeCloseDynBeacon(value0) {
        this.value0 = value0;
    };
    MakeCloseDynBeacon.create = function (value0) {
        return new MakeCloseDynBeacon(value0);
    };
    return MakeCloseDynBeacon;
})();
var MakePursx = /* #__PURE__ */ (function () {
    function MakePursx(value0) {
        this.value0 = value0;
    };
    MakePursx.create = function (value0) {
        return new MakePursx(value0);
    };
    return MakePursx;
})();
var SetProp = /* #__PURE__ */ (function () {
    function SetProp(value0) {
        this.value0 = value0;
    };
    SetProp.create = function (value0) {
        return new SetProp(value0);
    };
    return SetProp;
})();
var SetText = /* #__PURE__ */ (function () {
    function SetText(value0) {
        this.value0 = value0;
    };
    SetText.create = function (value0) {
        return new SetText(value0);
    };
    return SetText;
})();
var UnsetAttribute = /* #__PURE__ */ (function () {
    function UnsetAttribute(value0) {
        this.value0 = value0;
    };
    UnsetAttribute.create = function (value0) {
        return new UnsetAttribute(value0);
    };
    return UnsetAttribute;
})();
var SendToPos = /* #__PURE__ */ (function () {
    function SendToPos(value0) {
        this.value0 = value0;
    };
    SendToPos.create = function (value0) {
        return new SendToPos(value0);
    };
    return SendToPos;
})();
var MakeRoot = /* #__PURE__ */ (function () {
    function MakeRoot(value0) {
        this.value0 = value0;
    };
    MakeRoot.create = function (value0) {
        return new MakeRoot(value0);
    };
    return MakeRoot;
})();
var GiveNewParent = /* #__PURE__ */ (function () {
    function GiveNewParent(value0) {
        this.value0 = value0;
    };
    GiveNewParent.create = function (value0) {
        return new GiveNewParent(value0);
    };
    return GiveNewParent;
})();
var DisconnectElement = /* #__PURE__ */ (function () {
    function DisconnectElement(value0) {
        this.value0 = value0;
    };
    DisconnectElement.create = function (value0) {
        return new DisconnectElement(value0);
    };
    return DisconnectElement;
})();
var RemoveDynBeacon = /* #__PURE__ */ (function () {
    function RemoveDynBeacon(value0) {
        this.value0 = value0;
    };
    RemoveDynBeacon.create = function (value0) {
        return new RemoveDynBeacon(value0);
    };
    return RemoveDynBeacon;
})();
var DeleteFromCache = /* #__PURE__ */ (function () {
    function DeleteFromCache(value0) {
        this.value0 = value0;
    };
    DeleteFromCache.create = function (value0) {
        return new DeleteFromCache(value0);
    };
    return DeleteFromCache;
})();
var RenderableInstruction = /* #__PURE__ */ (function () {
    function RenderableInstruction(value0) {
        this.value0 = value0;
    };
    RenderableInstruction.create = function (value0) {
        return new RenderableInstruction(value0);
    };
    return RenderableInstruction;
})();
var EliminatableInstruction = /* #__PURE__ */ (function () {
    function EliminatableInstruction(value0) {
        this.value0 = value0;
    };
    EliminatableInstruction.create = function (value0) {
        return new EliminatableInstruction(value0);
    };
    return EliminatableInstruction;
})();
var EFunctionOfFFIDOMSnapshot = function (x) {
    return x;
};
var functorEFunctionOfFFIDOMS = {
    map: function (f) {
        return function (m) {
            return map(map1(map2(f)))(m);
        };
    }
};
var ssrUnsetAttribute = function (a) {
    return function (i) {
        return $$void(Control_Monad_ST_Internal.modify(function (v) {
            return append(v)([ new RenderableInstruction(new UnsetAttribute(a)) ]);
        })(i));
    };
};
var ssrSetText = function (a) {
    return function (i) {
        return $$void(Control_Monad_ST_Internal.modify(function (v) {
            return append(v)([ new RenderableInstruction(new SetText(a)) ]);
        })(i));
    };
};
var ssrSetProp = function (a) {
    return function (i) {
        return $$void(Control_Monad_ST_Internal.modify(function (v) {
            return append(v)([ new RenderableInstruction(new SetProp(a)) ]);
        })(i));
    };
};
var ssrSendToPos = function (a) {
    return function (i) {
        return $$void(Control_Monad_ST_Internal.modify(function (v) {
            return append(v)([ new EliminatableInstruction(new SendToPos(a)) ]);
        })(i));
    };
};
var ssrRemoveDynBeacon = function (a) {
    return function (i) {
        return $$void(Control_Monad_ST_Internal.modify(function (v) {
            return append(v)([ new EliminatableInstruction(new RemoveDynBeacon(a)) ]);
        })(i));
    };
};
var ssrMakeText = function (a) {
    return function (i) {
        return $$void(Control_Monad_ST_Internal.modify(function (v) {
            return append(v)([ new RenderableInstruction(new MakeText(a)) ]);
        })(i));
    };
};
var ssrMakeRoot = function (a) {
    return function (i) {
        return $$void(Control_Monad_ST_Internal.modify(function (v) {
            return append(v)([ new EliminatableInstruction(new MakeRoot(a)) ]);
        })(i));
    };
};
var ssrMakePursx = function (a) {
    return function (i) {
        return $$void(Control_Monad_ST_Internal.modify(function (v) {
            return append(v)([ new RenderableInstruction(new MakePursx(a)) ]);
        })(i));
    };
};
var ssrMakeElement = function (a) {
    return function (i) {
        return $$void(Control_Monad_ST_Internal.modify(function (v) {
            return append(v)([ new RenderableInstruction(new MakeElement(a)) ]);
        })(i));
    };
};
var ssrMakeDynBeacon = function (a) {
    return function (i) {
        return $$void(Control_Monad_ST_Internal.modify(function (v) {
            return append(v)([ new RenderableInstruction(new MakeOpenDynBeacon(a)), new RenderableInstruction(new MakeCloseDynBeacon(a)) ]);
        })(i));
    };
};
var ssrGiveNewParent = function (a) {
    return function (i) {
        return $$void(Control_Monad_ST_Internal.modify(function (v) {
            return append(v)([ new EliminatableInstruction(new GiveNewParent(a)) ]);
        })(i));
    };
};
var ssrDisconnectElement = function (a) {
    return function (i) {
        return $$void(Control_Monad_ST_Internal.modify(function (v) {
            return append(v)([ new EliminatableInstruction(new DisconnectElement(a)) ]);
        })(i));
    };
};
var ssrDeleteFromCache = function (a) {
    return function (i) {
        return $$void(Control_Monad_ST_Internal.modify(function (v) {
            return append(v)([ new EliminatableInstruction(new DeleteFromCache(a)) ]);
        })(i));
    };
};
var ssrDOMInterpret = function (seed) {
    return {
        ids: function __do() {
            var s = Control_Monad_ST_Internal.read(seed)();
            var o = show(Test_QuickCheck_Gen.evalGen(arbitrary)({
                newSeed: Random_LCG.mkSeed(s),
                size: 5
            }));
            $$void(Control_Monad_ST_Internal.modify(add(1))(seed))();
            return o;
        },
        makeElement: ssrMakeElement,
        attributeParent: function (v) {
            return function (v1) {
                return pure(Data_Unit.unit);
            };
        },
        makeRoot: ssrMakeRoot,
        makeText: ssrMakeText,
        makePursx: ssrMakePursx,
        setProp: ssrSetProp,
        unsetAttribute: ssrUnsetAttribute,
        makeDynBeacon: ssrMakeDynBeacon,
        setCb: function (v) {
            return function (v1) {
                return pure(Data_Unit.unit);
            };
        },
        setText: ssrSetText,
        sendToPos: ssrSendToPos,
        deleteFromCache: ssrDeleteFromCache,
        removeDynBeacon: ssrRemoveDynBeacon,
        giveNewParent: ssrGiveNewParent,
        disconnectElement: ssrDisconnectElement
    };
};
var runOnJust = function (v) {
    return function (v1) {
        if (v instanceof Data_Maybe.Just) {
            return v1(v.value0);
        };
        return pure1(false);
    };
};
var sendToPos = function (a) {
    return function (state) {
        return function __do() {
            var scope = $foreign.getScope(a.id)(state)();
            var parent = $foreign.getParent(a.id)(state)();
            var dynFamily = $foreign.getDynFamily(a.id)(state)();
            var newA = {
                scope: scope,
                parent: parent,
                dynFamily: dynFamily,
                id: a.id,
                pos: new Data_Maybe.Just(a.pos),
                ez: false,
                raiseId: mempty,
                ctor: Bolson_Core.envy(empty)
            };
            return coerce($foreign.giveNewParent_(Data_Maybe.Just.create)(runOnJust)(newA))(state)();
        };
    };
};
var __internalDekuFlatten = function (a) {
    return function (b) {
        return function (c) {
            return Bolson_Control.flatten({
                doLogic: function (pos) {
                    return function (v) {
                        return function (id) {
                            return v.sendToPos({
                                id: id,
                                pos: pos
                            });
                        };
                    };
                },
                ids: function ($82) {
                    return (function (v) {
                        return v.ids;
                    })(unwrap($82));
                },
                disconnectElement: function (v) {
                    return function (v1) {
                        return v.disconnectElement({
                            id: v1.id,
                            scope: v1.scope,
                            parent: v1.parent,
                            scopeEq: eq
                        });
                    };
                },
                toElt: function (v) {
                    return v;
                }
            })(a)(b)(coerce(c));
        };
    };
};
var giveNewParentOrReconstruct = function (di) {
    return function (just) {
        return function (roj) {
            return function (gnp) {
                return join(Control_Monad_Free.liftF(pure2(function (ffi) {
                    var needsFreshNut = (function () {
                        var v = map(function (a) {
                            return function (v1) {
                                return pure1(a);
                            };
                        })(__internalDekuFlatten({
                            dynFamily: gnp.dynFamily,
                            ez: gnp.ez,
                            parent: new Data_Maybe.Just(gnp.parent),
                            pos: gnp.pos,
                            raiseId: gnp.raiseId,
                            scope: gnp.scope
                        })(di)(gnp.ctor));
                        return pure1(Control_Monad_Free.wrap(v));
                    })();
                    var hasIdAndInScope = pure1(Control_Monad_Free.liftF(pure2($foreign.giveNewParent_(just)(roj)(gnp))));
                    return function __do() {
                        var hasId = $foreign.stateHasKey(gnp.id)(ffi)();
                        if (hasId) {
                            var scope = $foreign.getScope(gnp.id)(ffi)();
                            if (scope instanceof Bolson_Core.Global) {
                                return hasIdAndInScope();
                            };
                            if (scope instanceof Bolson_Core.Local && gnp.scope instanceof Bolson_Core.Local) {
                                var $79 = Data_String_Utils.includes(scope.value0)(gnp.scope.value0);
                                if ($79) {
                                    return hasIdAndInScope();
                                };
                                return needsFreshNut();
                            };
                            return needsFreshNut();
                        };
                        return needsFreshNut();
                    };
                })));
            };
        };
    };
};
var fullDOMInterpret = function (seed) {
    var l = {
        ids: function __do() {
            var s = Control_Monad_ST_Internal.read(seed)();
            var o = show(Test_QuickCheck_Gen.evalGen(arbitrary)({
                newSeed: Random_LCG.mkSeed(s),
                size: 5
            }));
            $$void(Control_Monad_ST_Internal.modify(add(1))(seed))();
            return o;
        },
        makeElement: (function () {
            var $83 = $foreign.makeElement_(runOnJust)(false);
            return function ($84) {
                return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($83($84))));
            };
        })(),
        makeDynBeacon: (function () {
            var $85 = $foreign.makeDynBeacon_(runOnJust)(false);
            return function ($86) {
                return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($85($86))));
            };
        })(),
        attributeParent: (function () {
            var $87 = $foreign.attributeParent_(runOnJust);
            return function ($88) {
                return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($87($88))));
            };
        })(),
        makeRoot: function ($89) {
            return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($foreign.makeRoot_($89))));
        },
        makeText: (function () {
            var $90 = $foreign.makeText_(runOnJust)(false)(Data_Maybe.maybe(Data_Unit.unit));
            return function ($91) {
                return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($90($91))));
            };
        })(),
        makePursx: (function () {
            var $92 = $foreign.makePursx_(runOnJust)(false)(Data_Maybe.maybe(Data_Unit.unit));
            return function ($93) {
                return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($92($93))));
            };
        })(),
        setProp: (function () {
            var $94 = $foreign.setProp_(false);
            return function ($95) {
                return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($94($95))));
            };
        })(),
        setCb: (function () {
            var $96 = $foreign.setCb_(false);
            return function ($97) {
                return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($96($97))));
            };
        })(),
        unsetAttribute: (function () {
            var $98 = $foreign.unsetAttribute_(false);
            return function ($99) {
                return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($98($99))));
            };
        })(),
        setText: function ($100) {
            return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($foreign.setText_($100))));
        },
        sendToPos: function ($101) {
            return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2(sendToPos($101))));
        },
        removeDynBeacon: function ($102) {
            return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($foreign.removeDynBeacon_($102))));
        },
        deleteFromCache: function ($103) {
            return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($foreign.deleteFromCache_($103))));
        },
        giveNewParent: function (gnp) {
            return giveNewParentOrReconstruct(l)(Data_Maybe.Just.create)(runOnJust)(gnp);
        },
        disconnectElement: function ($104) {
            return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($foreign.disconnectElement_($104))));
        }
    };
    return l;
};
var hydratingDOMInterpret = function (seed) {
    var l = {
        ids: function __do() {
            var s = Control_Monad_ST_Internal.read(seed)();
            var o = show(Test_QuickCheck_Gen.evalGen(arbitrary)({
                newSeed: Random_LCG.mkSeed(s),
                size: 5
            }));
            $$void(Control_Monad_ST_Internal.modify(add(1))(seed))();
            return o;
        },
        makeElement: (function () {
            var $105 = $foreign.makeElement_(runOnJust)(true);
            return function ($106) {
                return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($105($106))));
            };
        })(),
        makeDynBeacon: (function () {
            var $107 = $foreign.makeDynBeacon_(runOnJust)(true);
            return function ($108) {
                return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($107($108))));
            };
        })(),
        attributeParent: (function () {
            var $109 = $foreign.attributeParent_(runOnJust);
            return function ($110) {
                return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($109($110))));
            };
        })(),
        makeRoot: function ($111) {
            return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($foreign.makeRoot_($111))));
        },
        makeText: (function () {
            var $112 = $foreign.makeText_(runOnJust)(true)(Data_Maybe.maybe(Data_Unit.unit));
            return function ($113) {
                return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($112($113))));
            };
        })(),
        makePursx: (function () {
            var $114 = $foreign.makePursx_(runOnJust)(true)(Data_Maybe.maybe(Data_Unit.unit));
            return function ($115) {
                return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($114($115))));
            };
        })(),
        setProp: (function () {
            var $116 = $foreign.setProp_(true);
            return function ($117) {
                return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($116($117))));
            };
        })(),
        setCb: (function () {
            var $118 = $foreign.setCb_(true);
            return function ($119) {
                return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($118($119))));
            };
        })(),
        unsetAttribute: (function () {
            var $120 = $foreign.unsetAttribute_(true);
            return function ($121) {
                return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($120($121))));
            };
        })(),
        setText: function ($122) {
            return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($foreign.setText_($122))));
        },
        sendToPos: function ($123) {
            return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2(sendToPos($123))));
        },
        deleteFromCache: function ($124) {
            return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($foreign.deleteFromCache_($124))));
        },
        removeDynBeacon: function ($125) {
            return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($foreign.removeDynBeacon_($125))));
        },
        giveNewParent: function (gnp) {
            return giveNewParentOrReconstruct(l)(Data_Maybe.Just.create)(runOnJust)(gnp);
        },
        disconnectElement: function ($126) {
            return Control_Monad_Free.liftF(EFunctionOfFFIDOMSnapshot(pure2($foreign.disconnectElement_($126))));
        }
    };
    return l;
};
export {
    getAllComments,
    makeFFIDOMSnapshot,
    setHydrating,
    unSetHydrating
} from "./foreign.js";
export {
    SendToPos,
    MakeRoot,
    GiveNewParent,
    DisconnectElement,
    RemoveDynBeacon,
    DeleteFromCache,
    RenderableInstruction,
    EliminatableInstruction,
    MakeElement,
    MakeText,
    MakeOpenDynBeacon,
    MakeCloseDynBeacon,
    MakePursx,
    SetProp,
    SetText,
    UnsetAttribute,
    EFunctionOfFFIDOMSnapshot,
    fullDOMInterpret,
    hydratingDOMInterpret,
    ssrDOMInterpret,
    functorEFunctionOfFFIDOMS
};
