// Generated by purs version 0.15.9
import * as Color from "../Color/index.js";
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Data_Boolean from "../Data.Boolean/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_List from "../Data.List/index.js";
import * as Data_List_Types from "../Data.List.Types/index.js";
import * as Data_Monoid from "../Data.Monoid/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as Data_Semigroup from "../Data.Semigroup/index.js";
import * as Data_Show from "../Data.Show/index.js";
var map = /* #__PURE__ */ Data_Functor.map(Data_List_Types.functorList);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var intercalate = /* #__PURE__ */ Data_Foldable.intercalate(Data_List_Types.foldableList)(Data_Monoid.monoidString);
var mapFlipped = /* #__PURE__ */ Data_Functor.mapFlipped(Data_List_Types.functorList);
var append1 = /* #__PURE__ */ Data_Semigroup.append(Data_List_Types.semigroupList);
var between = /* #__PURE__ */ Data_Ord.between(Data_Ord.ordNumber);
var bind = /* #__PURE__ */ Control_Bind.bind(Data_List_Types.bindList);
var pure = /* #__PURE__ */ Control_Applicative.pure(Data_List_Types.applicativeList);
var comparing = /* #__PURE__ */ Data_Ord.comparing(Data_Ord.ordNumber);
var foldl = /* #__PURE__ */ Data_Foldable.foldl(Data_List_Types.foldableList);
var ColorStop = /* #__PURE__ */ (function () {
    function ColorStop(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    ColorStop.create = function (value0) {
        return function (value1) {
            return new ColorStop(value0, value1);
        };
    };
    return ColorStop;
})();
var ColorStops = /* #__PURE__ */ (function () {
    function ColorStops(value0, value1, value2) {
        this.value0 = value0;
        this.value1 = value1;
        this.value2 = value2;
    };
    ColorStops.create = function (value0) {
        return function (value1) {
            return function (value2) {
                return new ColorStops(value0, value1, value2);
            };
        };
    };
    return ColorStops;
})();
var ColorScale = /* #__PURE__ */ (function () {
    function ColorScale(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    ColorScale.create = function (value0) {
        return function (value1) {
            return new ColorScale(value0, value1);
        };
    };
    return ColorScale;
})();
var stopRatio = function (v) {
    return v.value1;
};
var stopColor = function (v) {
    return v.value0;
};
var ratio = /* #__PURE__ */ Data_Ord.clamp(Data_Ord.ordNumber)(0.0)(1.0);
var modify$prime = function (f) {
    return function (v) {
        var f$prime = function (v1) {
            return new ColorStop(f(v1.value1)(v1.value0), v1.value1);
        };
        return new ColorStops(f(0.0)(v.value0), map(f$prime)(v.value1), f(1.0)(v.value2));
    };
};
var modify = function (f) {
    return function (v) {
        return new ColorScale(v.value0, modify$prime(f)(v.value1));
    };
};
var cssColorStopsRGB = function (v) {
    if (v.value1 instanceof Data_List_Types.Nil) {
        return Color.cssStringHSLA(v.value0) + (", " + Color.cssStringHSLA(v.value2));
    };
    var percentage = function (r) {
        return show(r * 100.0) + "%";
    };
    var toString = function (v1) {
        return Color.cssStringHSLA(v1.value0) + (" " + percentage(v1.value1));
    };
    return Color.cssStringHSLA(v.value0) + (", " + (intercalate(", ")(map(toString)(v.value1)) + (", " + Color.cssStringHSLA(v.value2))));
};
var colors$prime = function (v) {
    return function (v1) {
        if (v1 === 0) {
            return Data_List_Types.Nil.value;
        };
        if (v1 === 1) {
            return new Data_List_Types.Cons(v(0.0), Data_List_Types.Nil.value);
        };
        var mkColor = function (i) {
            return v(Data_Int.toNumber(i) / Data_Int.toNumber(v1 - 1 | 0));
        };
        return map(mkColor)(Data_List.range(0)(v1 - 1 | 0));
    };
};
var colorStop = function (c) {
    return function (r) {
        return new ColorStop(c, ratio(r));
    };
};
var combineStops$prime = function (epsilon) {
    return function (at) {
        return function (v) {
            return function (v1) {
                var startStops = mapFlipped(v.value1)(function (stop) {
                    return colorStop(stopColor(stop))(stopRatio(stop) / (1.0 / at));
                });
                var midStops = new Data_List_Types.Cons(colorStop(v.value2)(at - epsilon), new Data_List_Types.Cons(colorStop(v1.value0)(at), Data_List_Types.Nil.value));
                var endStops = mapFlipped(v1.value1)(function (stop) {
                    return colorStop(stopColor(stop))(at + stopRatio(stop) / (1.0 / (1.0 - at)));
                });
                return new ColorStops(v.value0, append1(startStops)(append1(midStops)(endStops)), v1.value2);
            };
        };
    };
};
var combineStops = /* #__PURE__ */ combineStops$prime(1.0e-6);
var mkSimpleSampler = function (interpolate) {
    return function (v) {
        return function (x) {
            if (x < 0.0) {
                return v.value0;
            };
            if (x > 1.0) {
                return v.value2;
            };
            if (Data_Boolean.otherwise) {
                var go = function ($copy_v1) {
                    return function ($copy_v2) {
                        return function ($copy_v3) {
                            var $tco_var_v1 = $copy_v1;
                            var $tco_var_v2 = $copy_v2;
                            var $tco_done = false;
                            var $tco_result;
                            function $tco_loop(v1, v2, v3) {
                                if (v3 instanceof Data_List_Types.Nil) {
                                    $tco_done = true;
                                    return v1;
                                };
                                if (v3 instanceof Data_List_Types.Cons) {
                                    var $100 = between(v2)(v3.value0.value1)(x);
                                    if ($100) {
                                        var $101 = v2 === v3.value0.value1;
                                        if ($101) {
                                            $tco_done = true;
                                            return v1;
                                        };
                                        $tco_done = true;
                                        return interpolate(v1)(v3.value0.value0)((x - v2) / (v3.value0.value1 - v2));
                                    };
                                    $tco_var_v1 = v3.value0.value0;
                                    $tco_var_v2 = v3.value0.value1;
                                    $copy_v3 = v3.value1;
                                    return;
                                };
                                throw new Error("Failed pattern match at Color.Scale (line 170, column 7 - line 170, column 25): " + [ v1.constructor.name, v2.constructor.name, v3.constructor.name ]);
                            };
                            while (!$tco_done) {
                                $tco_result = $tco_loop($tco_var_v1, $tco_var_v2, $copy_v3);
                            };
                            return $tco_result;
                        };
                    };
                };
                return go(v.value0)(0.0)(Data_List.snoc(v.value1)(colorStop(v.value2)(1.0)));
            };
            throw new Error("Failed pattern match at Color.Scale (line 164, column 1 - line 164, column 65): " + [ interpolate.constructor.name, v.constructor.name, x.constructor.name ]);
        };
    };
};
var cubehelixSample = /* #__PURE__ */ mkSimpleSampler(/* #__PURE__ */ Color.mixCubehelix(1.0));
var sample = function (v) {
    return mkSimpleSampler(Color.mix(v.value0))(v.value1);
};
var colors = function (scale) {
    return colors$prime(sample(scale));
};
var reverseStops = function (v) {
    var newStops = mapFlipped(Data_List.reverse(v.value1))(function (stop) {
        return colorStop(stopColor(stop))(1.0 - stopRatio(stop));
    });
    return new ColorStops(v.value2, newStops, v.value0);
};
var uniformScale$prime = function (dictFoldable) {
    var fromFoldable = Data_List.fromFoldable(dictFoldable);
    return function (b) {
        return function (middle) {
            return function (e) {
                var cs = fromFoldable(middle);
                var len = Data_List.length(cs);
                var n = 1 + len | 0;
                var makeStop = function (i) {
                    return function (col) {
                        return colorStop(col)(Data_Int.toNumber(i) / Data_Int.toNumber(n));
                    };
                };
                var stops = Data_List.zipWith(makeStop)(Data_List.range(1)(n))(cs);
                return new ColorStops(b, stops, e);
            };
        };
    };
};
var uniformScale = function (dictFoldable) {
    var uniformScale$prime1 = uniformScale$prime(dictFoldable);
    return function (mode) {
        return function (b) {
            return function (middle) {
                return function (e) {
                    return new ColorScale(mode, uniformScale$prime1(b)(middle)(e));
                };
            };
        };
    };
};
var uniformScale1 = /* #__PURE__ */ uniformScale(Data_List_Types.foldableList);
var yellowToRed = /* #__PURE__ */ (function () {
    var yellow = Color.fromInt(16777164);
    var red = Color.fromInt(8388646);
    var orange = Color.fromInt(16616764);
    return uniformScale1(Color.Lab.value)(yellow)(new Data_List_Types.Cons(orange, Data_List_Types.Nil.value))(red);
})();
var colorScale = function (space) {
    return function (b) {
        return function (middle) {
            return function (e) {
                return new ColorScale(space, new ColorStops(b, middle, e));
            };
        };
    };
};
var cool = /* #__PURE__ */ (function () {
    return colorScale(Color.RGB.value)(Color.hsl(180.0)(1.0)(0.6))(Data_List_Types.Nil.value)(Color.hsl(300.0)(1.0)(0.5));
})();
var grayscale = /* #__PURE__ */ (function () {
    return colorScale(Color.RGB.value)(Color.black)(Data_List_Types.Nil.value)(Color.white);
})();
var hot = /* #__PURE__ */ (function () {
    return colorScale(Color.RGB.value)(Color.black)(new Data_List_Types.Cons(colorStop(Color.fromInt(16711680))(0.5), new Data_List_Types.Cons(colorStop(Color.fromInt(16776960))(0.75), Data_List_Types.Nil.value)))(Color.white);
})();
var spectrum = /* #__PURE__ */ (function () {
    var stops = bind(Data_List.range(1)(35))(function (i) {
        var r = Data_Int.toNumber(i);
        return pure(colorStop(Color.hsl(10.0 * r)(1.0)(0.5))(r / 36.0));
    });
    var end = Color.hsl(0.0)(1.0)(0.5);
    return colorScale(Color.HSL.value)(end)(stops)(end);
})();
var spectrumLCh = /* #__PURE__ */ (function () {
    var end = Color.lch(70.0)(35.0)(0.0);
    var stops = bind(Data_List.range(1)(35))(function (i) {
        var r = Data_Int.toNumber(i);
        return pure(colorStop(Color.lch(70.0)(35.0)(10.0 * r))(r / 36.0));
    });
    return colorScale(Color.LCh.value)(end)(stops)(end);
})();
var blueToRed = /* #__PURE__ */ (function () {
    var red = Color.fromInt(11671595);
    var gray = Color.fromInt(16250871);
    var blue = Color.fromInt(2188972);
    return uniformScale1(Color.Lab.value)(blue)(new Data_List_Types.Cons(gray, Data_List_Types.Nil.value))(red);
})();
var addStop$prime = function (v) {
    return function (c) {
        return function (r) {
            var stop = colorStop(c)(r);
            return new ColorStops(v.value0, Data_List.insertBy(comparing(stopRatio))(stop)(v.value1), v.value2);
        };
    };
};
var minColorStops = function (v) {
    return function (v1) {
        return function (v2) {
            if (v === 0) {
                return v2;
            };
            var insertStops = foldl(function (stops$prime) {
                return function (v3) {
                    return addStop$prime(stops$prime)(v3.value0)(v3.value1);
                };
            });
            var additionalStops = (function () {
                var $128 = v <= 2;
                if ($128) {
                    return Data_List_Types.Nil.value;
                };
                return bind(Data_List.range(1)(v - 1 | 0))(function (step) {
                    var frac = ratio(Data_Int.toNumber(step) / Data_Int.toNumber(v));
                    return pure(new ColorStop(v1(v2)(frac), frac));
                });
            })();
            return insertStops(v2)(additionalStops);
        };
    };
};
var cssColorStops = function (v) {
    if (v.value0 instanceof Color.RGB) {
        return cssColorStopsRGB(v.value1);
    };
    return cssColorStopsRGB(minColorStops(10)(mkSimpleSampler(Color.mix(v.value0)))(v.value1));
};
var cubehelix = /* #__PURE__ */ (function () {
    var e = Color.hsl(-240.0)(0.5)(1.0);
    var b = Color.hsl(300.0)(0.5)(0.0);
    var gen = function (v) {
        return Color.mixCubehelix(1.0)(b)(e);
    };
    return new ColorScale(Color.HSL.value, minColorStops(100)(gen)(new ColorStops(b, Data_List_Types.Nil.value, e)));
})();
var addStop = function (v) {
    return function (c) {
        return function (r) {
            return new ColorScale(v.value0, addStop$prime(v.value1)(c)(r));
        };
    };
};
export {
    colorStop,
    stopRatio,
    stopColor,
    colorScale,
    ColorStops,
    combineStops$prime,
    combineStops,
    reverseStops,
    uniformScale,
    uniformScale$prime,
    addStop,
    addStop$prime,
    sample,
    cubehelixSample,
    mkSimpleSampler,
    colors,
    colors$prime,
    modify,
    modify$prime,
    grayscale,
    hot,
    cool,
    spectrum,
    spectrumLCh,
    blueToRed,
    yellowToRed,
    cubehelix,
    minColorStops,
    cssColorStops,
    cssColorStopsRGB
};
